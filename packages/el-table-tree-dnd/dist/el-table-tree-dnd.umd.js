(function(k,c){typeof exports=="object"&&typeof module<"u"?c(exports,require("vue")):typeof define=="function"&&define.amd?define(["exports","vue"],c):(k=typeof globalThis<"u"?globalThis:k||self,c(k.ElTableTreeDnd={},k.Vue))})(this,function(k,c){"use strict";function R(){for(var e=arguments.length,r=new Array(e),t=0;t<e;t++)r[t]=arguments[t];return function(){r.forEach(function(a){return a()})}}function He(e){if(Array.isArray(e))return e}function Me(e,r){var t=e==null?null:typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(t!=null){var n,a,i,l,d=[],u=!0,v=!1;try{if(i=(t=t.call(e)).next,r!==0)for(;!(u=(n=i.call(t)).done)&&(d.push(n.value),d.length!==r);u=!0);}catch(T){v=!0,a=T}finally{try{if(!u&&t.return!=null&&(l=t.return(),Object(l)!==l))return}finally{if(v)throw a}}return d}}function _(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=Array(r);t<r;t++)n[t]=e[t];return n}function le(e,r){if(e){if(typeof e=="string")return _(e,r);var t={}.toString.call(e).slice(8,-1);return t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set"?Array.from(e):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?_(e,r):void 0}}function Re(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function ue(e,r){return He(e)||Me(e,r)||le(e,r)||Re()}var de=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},L={},F={};Object.defineProperty(F,"__esModule",{value:!0}),F.bind=void 0;function Fe(e,r){var t=r.type,n=r.listener,a=r.options;return e.addEventListener(t,n,a),function(){e.removeEventListener(t,n,a)}}F.bind=Fe;var X={},H=de&&de.__assign||function(){return H=Object.assign||function(e){for(var r,t=1,n=arguments.length;t<n;t++){r=arguments[t];for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(e[a]=r[a])}return e},H.apply(this,arguments)};Object.defineProperty(X,"__esModule",{value:!0}),X.bindAll=void 0;var Ke=F;function ce(e){if(!(typeof e>"u"))return typeof e=="boolean"?{capture:e}:e}function $e(e,r){if(r==null)return e;var t=H(H({},e),{options:H(H({},ce(r)),ce(e.options))});return t}function We(e,r,t){var n=r.map(function(a){var i=$e(a,t);return(0,Ke.bind)(e,i)});return function(){n.forEach(function(i){return i()})}}X.bindAll=We,function(e){Object.defineProperty(e,"__esModule",{value:!0}),e.bindAll=e.bind=void 0;var r=F;Object.defineProperty(e,"bind",{enumerable:!0,get:function(){return r.bind}});var t=X;Object.defineProperty(e,"bindAll",{enumerable:!0,get:function(){return t.bindAll}})}(L);var se="data-pdnd-honey-pot";function fe(e){return e instanceof Element&&e.hasAttribute(se)}function pe(e){var r=document.elementsFromPoint(e.x,e.y),t=ue(r,2),n=t[0],a=t[1];return n?fe(n)?a??null:n:null}function K(e){"@babel/helpers - typeof";return K=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},K(e)}function ze(e,r){if(K(e)!="object"||!e)return e;var t=e[Symbol.toPrimitive];if(t!==void 0){var n=t.call(e,r||"default");if(K(n)!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(e)}function Ye(e){var r=ze(e,"string");return K(r)=="symbol"?r:r+""}function $(e,r,t){return(r=Ye(r))in e?Object.defineProperty(e,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):e[r]=t,e}var Ue=2147483647;function ve(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function ge(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?ve(Object(t),!0).forEach(function(n){$(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):ve(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var W=2,ye=W/2;function Ve(e){return{x:Math.floor(e.x),y:Math.floor(e.y)}}function Xe(e){return{x:e.x-ye,y:e.y-ye}}function qe(e){return{x:Math.max(e.x,0),y:Math.max(e.y,0)}}function _e(e){return{x:Math.min(e.x,window.innerWidth-W),y:Math.min(e.y,window.innerHeight-W)}}function me(e){var r=e.client,t=_e(qe(Xe(Ve(r))));return DOMRect.fromRect({x:t.x,y:t.y,width:W,height:W})}function he(e){var r=e.clientRect;return{left:"".concat(r.left,"px"),top:"".concat(r.top,"px"),width:"".concat(r.width,"px"),height:"".concat(r.height,"px")}}function Ge(e){var r=e.client,t=e.clientRect;return r.x>=t.x&&r.x<=t.x+t.width&&r.y>=t.y&&r.y<=t.y+t.height}function Ze(e){var r=e.initial,t=document.createElement("div");t.setAttribute(se,"true");var n=me({client:r});Object.assign(t.style,ge(ge({backgroundColor:"transparent",position:"fixed",padding:0,margin:0,boxSizing:"border-box"},he({clientRect:n})),{},{pointerEvents:"auto",zIndex:Ue})),document.body.appendChild(t);var a=L.bind(window,{type:"pointermove",listener:function(l){var d={x:l.clientX,y:l.clientY};n=me({client:d}),Object.assign(t.style,he({clientRect:n}))},options:{capture:!0}});return function(l){var d=l.current;if(a(),Ge({client:d,clientRect:n})){t.remove();return}function u(){v(),t.remove()}var v=L.bindAll(window,[{type:"pointerdown",listener:u},{type:"pointermove",listener:u},{type:"focusin",listener:u},{type:"focusout",listener:u},{type:"dragstart",listener:u},{type:"dragenter",listener:u},{type:"dragover",listener:u}],{capture:!0})}}function Je(){var e=null;function r(){return e=null,L.bind(window,{type:"pointermove",listener:function(a){e={x:a.clientX,y:a.clientY}},options:{capture:!0}})}function t(){var n=null;return function(i){var l=i.eventName,d=i.payload;if(l==="onDragStart"){var u,v=d.location.initial.input,T=(u=e)!==null&&u!==void 0?u:{x:v.clientX,y:v.clientY};n=Ze({initial:T})}if(l==="onDrop"){var g,m=d.location.current.input;(g=n)===null||g===void 0||g({current:{x:m.clientX,y:m.clientY}}),n=null,e=null}}}return{bindEvents:r,getOnPostDispatch:t}}function Qe(e){if(Array.isArray(e))return _(e)}function et(e){if(typeof Symbol<"u"&&e[Symbol.iterator]!=null||e["@@iterator"]!=null)return Array.from(e)}function tt(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function be(e){return Qe(e)||et(e)||le(e)||tt()}function G(e){var r=null;return function(){if(!r){for(var n=arguments.length,a=new Array(n),i=0;i<n;i++)a[i]=arguments[i];var l=e.apply(this,a);r={result:l}}return r.result}}var rt=G(function(){return process.env.NODE_ENV==="test"?!1:navigator.userAgent.includes("Firefox")}),Z=G(function(){if(process.env.NODE_ENV==="test")return!1;var r=navigator,t=r.userAgent;return t.includes("AppleWebKit")&&!t.includes("Chrome")}),J={isLeavingWindow:Symbol("leaving"),isEnteringWindow:Symbol("entering")};function nt(e){var r=e.dragLeave;return Z()?r.hasOwnProperty(J.isLeavingWindow):!1}(function(){if(typeof window>"u"||process.env.NODE_ENV==="test"||!Z())return;function r(){return{enterCount:0,isOverWindow:!1}}var t=r();function n(){t=r()}L.bindAll(window,[{type:"dragstart",listener:function(){t.enterCount=0,t.isOverWindow=!0}},{type:"drop",listener:n},{type:"dragend",listener:n},{type:"dragenter",listener:function(i){!t.isOverWindow&&t.enterCount===0&&(i[J.isEnteringWindow]=!0),t.isOverWindow=!0,t.enterCount++}},{type:"dragleave",listener:function(i){t.enterCount--,t.isOverWindow&&t.enterCount===0&&(i[J.isLeavingWindow]=!0,t.isOverWindow=!1)}}],{capture:!0})})();function at(e){return"nodeName"in e}function it(e){return at(e)&&e.ownerDocument!==document}function ot(e){var r=e.dragLeave,t=r.type,n=r.relatedTarget;return t!=="dragleave"?!1:Z()?nt({dragLeave:r}):n==null?!0:rt()?it(n):n instanceof HTMLIFrameElement}function lt(e){var r=e.onDragEnd;return[{type:"pointermove",listener:function(){var t=0;return function(){if(t<20){t++;return}r()}}()},{type:"pointerdown",listener:r}]}function z(e){return{altKey:e.altKey,button:e.button,buttons:e.buttons,ctrlKey:e.ctrlKey,metaKey:e.metaKey,shiftKey:e.shiftKey,clientX:e.clientX,clientY:e.clientY,pageX:e.pageX,pageY:e.pageY}}var ut=function(r){var t=[],n=null,a=function(){for(var l=arguments.length,d=new Array(l),u=0;u<l;u++)d[u]=arguments[u];t=d,!n&&(n=requestAnimationFrame(function(){n=null,r.apply(void 0,t)}))};return a.cancel=function(){n&&(cancelAnimationFrame(n),n=null)},a},Q=ut(function(e){return e()}),q=function(){var e=null;function r(n){var a=requestAnimationFrame(function(){e=null,n()});e={frameId:a,fn:n}}function t(){e&&(cancelAnimationFrame(e.frameId),e.fn(),e=null)}return{schedule:r,flush:t}}();function dt(e){var r=e.source,t=e.initial,n=e.dispatchEvent,a={dropTargets:[]};function i(d){n(d),a={dropTargets:d.payload.location.current.dropTargets}}var l={start:function(u){var v=u.nativeSetDragImage,T={current:t,previous:a,initial:t};i({eventName:"onGenerateDragPreview",payload:{source:r,location:T,nativeSetDragImage:v}}),q.schedule(function(){i({eventName:"onDragStart",payload:{source:r,location:T}})})},dragUpdate:function(u){var v=u.current;q.flush(),Q.cancel(),i({eventName:"onDropTargetChange",payload:{source:r,location:{initial:t,previous:a,current:v}}})},drag:function(u){var v=u.current;Q(function(){q.flush();var T={initial:t,previous:a,current:v};i({eventName:"onDrag",payload:{source:r,location:T}})})},drop:function(u){var v=u.current,T=u.updatedSourcePayload;q.flush(),Q.cancel(),i({eventName:"onDrop",payload:{source:T??r,location:{current:v,previous:a,initial:t}}})}};return l}var ee={isActive:!1};function we(){return!ee.isActive}function ct(e){return e.dataTransfer?e.dataTransfer.setDragImage.bind(e.dataTransfer):null}function st(e){var r=e.current,t=e.next;if(r.length!==t.length)return!0;for(var n=0;n<r.length;n++)if(r[n].element!==t[n].element)return!0;return!1}function ft(e){var r=e.event,t=e.dragType,n=e.getDropTargetsOver,a=e.dispatchEvent;if(!we())return;var i=pt({event:r,dragType:t,getDropTargetsOver:n});ee.isActive=!0;var l={current:i};te({event:r,current:i.dropTargets});var d=dt({source:t.payload,dispatchEvent:a,initial:i});function u(f){var h=st({current:l.current.dropTargets,next:f.dropTargets});l.current=f,h&&d.dragUpdate({current:l.current})}function v(f){var h=z(f),s=fe(f.target)?pe({x:h.clientX,y:h.clientY}):f.target,y=n({target:s,input:h,source:t.payload,current:l.current.dropTargets});y.length&&(f.preventDefault(),te({event:f,current:y})),u({dropTargets:y,input:h})}function T(){l.current.dropTargets.length&&u({dropTargets:[],input:l.current.input}),d.drop({current:l.current,updatedSourcePayload:null}),g()}function g(){ee.isActive=!1,m()}var m=L.bindAll(window,[{type:"dragover",listener:function(h){v(h),d.drag({current:l.current})}},{type:"dragenter",listener:v},{type:"dragleave",listener:function(h){ot({dragLeave:h})&&(u({input:l.current.input,dropTargets:[]}),t.startedFrom==="external"&&T())}},{type:"drop",listener:function(h){if(l.current={dropTargets:l.current.dropTargets,input:z(h)},!l.current.dropTargets.length){T();return}h.preventDefault(),te({event:h,current:l.current.dropTargets}),d.drop({current:l.current,updatedSourcePayload:t.type==="external"?t.getDropPayload(h):null}),g()}},{type:"dragend",listener:function(h){l.current={dropTargets:l.current.dropTargets,input:z(h)},T()}}].concat(be(lt({onDragEnd:T}))),{capture:!0});d.start({nativeSetDragImage:ct(r)})}function te(e){var r,t=e.event,n=e.current,a=(r=n[0])===null||r===void 0?void 0:r.dropEffect;a!=null&&t.dataTransfer&&(t.dataTransfer.dropEffect=a)}function pt(e){var r=e.event,t=e.dragType,n=e.getDropTargetsOver,a=z(r);if(t.startedFrom==="external")return{input:a,dropTargets:[]};var i=n({input:a,source:t.payload,target:r.target,current:[]});return{input:a,dropTargets:i}}var De={canStart:we,start:ft},re=new Map;function vt(e){var r=e.typeKey,t=e.mount,n=re.get(r);if(n)return n.usageCount++,n;var a={typeKey:r,unmount:t(),usageCount:1};return re.set(r,a),a}function gt(e){var r=vt(e);return function(){r.usageCount--,!(r.usageCount>0)&&(r.unmount(),re.delete(e.typeKey))}}function Oe(e,r){var t=r.attribute,n=r.value;return e.setAttribute(t,n),function(){return e.removeAttribute(t)}}function Te(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function B(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?Te(Object(t),!0).forEach(function(n){$(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Te(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function ne(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=yt(e))||r){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(v){throw v},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,l=!1,d;return{s:function(){t=t.call(e)},n:function(){var v=t.next();return i=v.done,v},e:function(v){l=!0,d=v},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(l)throw d}}}}function yt(e,r){if(e){if(typeof e=="string")return Ee(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Ee(e,r)}}function Ee(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function ae(e){return e.slice(0).reverse()}function mt(e){var r=e.typeKey,t=e.defaultDropEffect,n=new WeakMap,a="data-drop-target-for-".concat(r),i="[".concat(a,"]");function l(f){return n.set(f.element,f),function(){return n.delete(f.element)}}function d(f){if(process.env.NODE_ENV!=="production"){var h=n.get(f.element);h&&console.warn("You have already registered a [".concat(r,"] dropTarget on the same element"),{existing:h,proposed:f}),f.element instanceof HTMLIFrameElement&&console.warn(`
            We recommend not registering <iframe> elements as drop targets
            as it can result in some strange browser event ordering.
          `.replace(/\s{2,}/g," ").trim())}return R(Oe(f.element,{attribute:a,value:"true"}),l(f))}function u(f){var h,s,y,o,b=f.source,w=f.target,D=f.input,p=f.result,O=p===void 0?[]:p;if(w==null)return O;if(!(w instanceof Element))return w instanceof Node?u({source:b,target:w.parentElement,input:D,result:O}):O;var P=w.closest(i);if(P==null)return O;var A=n.get(P);if(A==null)return O;var I={input:D,source:b,element:A.element};if(A.canDrop&&!A.canDrop(I))return u({source:b,target:A.element.parentElement,input:D,result:O});var j=(h=(s=A.getData)===null||s===void 0?void 0:s.call(A,I))!==null&&h!==void 0?h:{},C=(y=(o=A.getDropEffect)===null||o===void 0?void 0:o.call(A,I))!==null&&y!==void 0?y:t,S={data:j,element:A.element,dropEffect:C,isActiveDueToStickiness:!1};return u({source:b,target:A.element.parentElement,input:D,result:[].concat(be(O),[S])})}function v(f){var h=f.eventName,s=f.payload,y=ne(s.location.current.dropTargets),o;try{for(y.s();!(o=y.n()).done;){var b,w=o.value,D=n.get(w.element),p=B(B({},s),{},{self:w});D==null||(b=D[h])===null||b===void 0||b.call(D,p)}}catch(O){y.e(O)}finally{y.f()}}var T={onGenerateDragPreview:v,onDrag:v,onDragStart:v,onDrop:v,onDropTargetChange:function(h){var s=h.payload,y=new Set(s.location.current.dropTargets.map(function(V){return V.element})),o=new Set,b=ne(s.location.previous.dropTargets),w;try{for(b.s();!(w=b.n()).done;){var D,p=w.value;o.add(p.element);var O=n.get(p.element),P=y.has(p.element),A=B(B({},s),{},{self:p});if(O==null||(D=O.onDropTargetChange)===null||D===void 0||D.call(O,A),!P){var I;O==null||(I=O.onDragLeave)===null||I===void 0||I.call(O,A)}}}catch(V){b.e(V)}finally{b.f()}var j=ne(s.location.current.dropTargets),C;try{for(j.s();!(C=j.n()).done;){var S,x,M=C.value;if(!o.has(M.element)){var U=B(B({},s),{},{self:M}),N=n.get(M.element);N==null||(S=N.onDropTargetChange)===null||S===void 0||S.call(N,U),N==null||(x=N.onDragEnter)===null||x===void 0||x.call(N,U)}}}catch(V){j.e(V)}finally{j.f()}}};function g(f){T[f.eventName](f)}function m(f){var h=f.source,s=f.target,y=f.input,o=f.current,b=u({source:h,target:s,input:y});if(b.length>=o.length)return b;for(var w=ae(o),D=ae(b),p=[],O=0;O<w.length;O++){var P,A=w[O],I=D[O];if(I!=null){p.push(I);continue}var j=p[O-1],C=w[O-1];if((j==null?void 0:j.element)!==(C==null?void 0:C.element))break;var S=n.get(A.element);if(!S)break;var x={input:y,source:h,element:S.element};if(S.canDrop&&!S.canDrop(x)||!((P=S.getIsSticky)!==null&&P!==void 0&&P.call(S,x)))break;p.push(B(B({},A),{},{isActiveDueToStickiness:!0}))}return ae(p)}return{dropTargetForConsumers:d,getIsOver:m,dispatchEvent:g}}function ht(e,r){var t=typeof Symbol<"u"&&e[Symbol.iterator]||e["@@iterator"];if(!t){if(Array.isArray(e)||(t=bt(e))||r){t&&(e=t);var n=0,a=function(){};return{s:a,n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(v){throw v},f:a}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var i=!0,l=!1,d;return{s:function(){t=t.call(e)},n:function(){var v=t.next();return i=v.done,v},e:function(v){l=!0,d=v},f:function(){try{!i&&t.return!=null&&t.return()}finally{if(l)throw d}}}}function bt(e,r){if(e){if(typeof e=="string")return Se(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);if(t==="Object"&&e.constructor&&(t=e.constructor.name),t==="Map"||t==="Set")return Array.from(e);if(t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t))return Se(e,r)}}function Se(e,r){(r==null||r>e.length)&&(r=e.length);for(var t=0,n=new Array(r);t<r;t++)n[t]=e[t];return n}function Ae(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function wt(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?Ae(Object(t),!0).forEach(function(n){$(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):Ae(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}function Dt(){var e=new Set,r=null;function t(i){r&&(!i.canMonitor||i.canMonitor(r.canMonitorArgs))&&r.active.add(i)}function n(i){var l=wt({},i);return e.add(l),t(l),function(){e.delete(l),r&&r.active.delete(l)}}function a(i){var l=i.eventName,d=i.payload;if(l==="onGenerateDragPreview"){r={canMonitorArgs:{initial:d.location.initial,source:d.source},active:new Set};var u=ht(e),v;try{for(u.s();!(v=u.n()).done;){var T=v.value;t(T)}}catch(y){u.e(y)}finally{u.f()}}if(r){for(var g=Array.from(r.active),m=0,f=g;m<f.length;m++){var h=f[m];if(r.active.has(h)){var s;(s=h[l])===null||s===void 0||s.call(h,d)}}l==="onDrop"&&(r.active.clear(),r=null)}}return{dispatchEvent:a,monitorForConsumers:n}}function Ot(e){var r=e.typeKey,t=e.mount,n=e.dispatchEventToSource,a=e.onPostDispatch,i=e.defaultDropEffect,l=Dt(),d=mt({typeKey:r,defaultDropEffect:i});function u(g){n==null||n(g),d.dispatchEvent(g),l.dispatchEvent(g),a==null||a(g)}function v(g){var m=g.event,f=g.dragType;De.start({event:m,dragType:f,getDropTargetsOver:d.getIsOver,dispatchEvent:u})}function T(){function g(){var m={canStart:De.canStart,start:v};return t(m)}return gt({typeKey:r,mount:g})}return{registerUsage:T,dropTarget:d.dropTargetForConsumers,monitor:l.monitorForConsumers}}var Tt=G(function(){return navigator.userAgent.toLocaleLowerCase().includes("android")}),Et="pdnd:android-fallback",xe="text/plain",St="text/uri-list",At="application/vnd.pdnd",Y=new WeakMap;function xt(e){return Y.set(e.element,e),function(){Y.delete(e.element)}}var Pe=Je(),ie=Ot({typeKey:"element",defaultDropEffect:"move",mount:function(r){return R(Pe.bindEvents(),L.bind(document,{type:"dragstart",listener:function(n){var a,i,l,d,u,v;if(r.canStart(n)&&!n.defaultPrevented){if(!n.dataTransfer){process.env.NODE_ENV!=="production"&&console.warn(`
              It appears as though you have are not testing DragEvents correctly.

              - If you are unit testing, ensure you have polyfilled DragEvent.
              - If you are browser testing, ensure you are dispatching drag events correctly.

              Please see our testing guides for more information:
              https://atlassian.design/components/pragmatic-drag-and-drop/core-package/testing
            `.replace(/ {2}/g,""));return}var T=n.target;if(!(T instanceof HTMLElement))return null;var g=Y.get(T);if(!g)return null;var m=z(n),f={element:g.element,dragHandle:(a=g.dragHandle)!==null&&a!==void 0?a:null,input:m};if(g.canDrag&&!g.canDrag(f))return n.preventDefault(),null;if(g.dragHandle){var h=pe({x:m.clientX,y:m.clientY});if(!g.dragHandle.contains(h))return n.preventDefault(),null}var s=(i=(l=g.getInitialDataForExternal)===null||l===void 0?void 0:l.call(g,f))!==null&&i!==void 0?i:null;if(s)for(var y=0,o=Object.entries(s);y<o.length;y++){var b=ue(o[y],2),w=b[0],D=b[1];n.dataTransfer.setData(w,D??"")}var p=n.dataTransfer.types;Tt()&&!p.includes(xe)&&!p.includes(St)&&n.dataTransfer.setData(xe,Et),n.dataTransfer.setData(At,"");var O={element:g.element,dragHandle:(d=g.dragHandle)!==null&&d!==void 0?d:null,data:(u=(v=g.getInitialData)===null||v===void 0?void 0:v.call(g,f))!==null&&u!==void 0?u:{}},P={type:"element",payload:O,startedFrom:"internal"};r.start({event:n,dragType:P})}}}))},dispatchEventToSource:function(r){var t,n,a=r.eventName,i=r.payload;(t=Y.get(i.source.element))===null||t===void 0||(n=t[a])===null||n===void 0||n.call(t,i)},onPostDispatch:Pe.getOnPostDispatch()}),Pt=ie.dropTarget,Ie=ie.monitor;function It(e){if(process.env.NODE_ENV!=="production"&&e.dragHandle&&!e.element.contains(e.dragHandle)&&console.warn("Drag handle element must be contained in draggable element",{element:e.element,dragHandle:e.dragHandle}),process.env.NODE_ENV!=="production"){var r=Y.get(e.element);r&&console.warn("You have already registered a `draggable` on the same element",{existing:r,proposed:e})}return R(ie.registerUsage(),xt(e),Oe(e.element,{attribute:"draggable",value:"true"}))}function jt(e,r){if(e==null)return{};var t={};for(var n in e)if({}.hasOwnProperty.call(e,n)){if(r.includes(n))continue;t[n]=e[n]}return t}function Ct(e,r){if(e==null)return{};var t,n,a=jt(e,r);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(n=0;n<i.length;n++)t=i[n],r.includes(t)||{}.propertyIsEnumerable.call(e,t)&&(a[t]=e[t])}return a}var kt=["block"];function je(e,r){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);r&&(n=n.filter(function(a){return Object.getOwnPropertyDescriptor(e,a).enumerable})),t.push.apply(t,n)}return t}function Ce(e){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?je(Object(t),!0).forEach(function(n){$(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):je(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var ke=Symbol("tree-item-instruction");function Bt(e){return{x:(e.right+e.left)/2,y:(e.bottom+e.top)/2}}function oe(e){var r=e.client,t=e.borderBox,n=t.height/4;return r.y<=t.top+n?"reorder-above":r.y>=t.bottom-n?"reorder-below":"make-child"}function Nt(e){var r=e.element,t=e.input,n=e.currentLevel,a=e.indentPerLevel,i=e.mode,l={x:t.clientX,y:t.clientY},d=r.getBoundingClientRect();if(i==="standard"){var u=oe({borderBox:d,client:l});return{type:u,indentPerLevel:a,currentLevel:n}}var v=Bt(d);if(i==="expanded"){var T=oe({borderBox:d,client:l});return{type:T==="reorder-above"?T:"make-child",indentPerLevel:a,currentLevel:n}}var g=a*n;if(l.x<d.left+g){if(l.y<v.y)return{type:"reorder-above",indentPerLevel:a,currentLevel:n};var m=(l.x-d.left)/a,f=Math.max(Math.floor(m),0);return{type:"reparent",desiredLevel:f,indentPerLevel:a,currentLevel:n}}return{type:oe({borderBox:d,client:l}),indentPerLevel:a,currentLevel:n}}function Lt(e,r){var t=Object.keys(e).sort(),n=Object.keys(r).sort();return t.length!==n.length?!1:t.every(function(a){return e[a]===r[a]})}function Be(e,r){return e.type!==r.type?!1:e.type==="instruction-blocked"&&r.type==="instruction-blocked"?Be(e.desired,r.desired):Lt(e,r)}var Ht=function(){var e=null;return function(r){return e&&Be(e,r)?e:(e=r,r)}}();function Mt(e){var r=e.desired,t=e.block;if(t!=null&&t.includes(r.type)&&r.type!=="instruction-blocked"){var n={type:"instruction-blocked",desired:r};return n}return r}function Rt(e,r){var t=r.block,n=Ct(r,kt),a=Nt(n),i=Mt({desired:a,block:t}),l=Ht(i);return Ce(Ce({},e),{},$({},ke,l))}function Ne(e){var r;return(r=e[ke])!==null&&r!==void 0?r:null}const E={remove(e,r){if(!Array.isArray(e)||!r)throw new Error("Invalid input for remove method");return e.filter(t=>t.id!==r).map(t=>({...t,children:t.children?E.remove(t.children,r):void 0}))},insertBefore(e,r,t){if(!Array.isArray(e)||!r||!t)throw new Error("Invalid input for insertBefore method");return e.reduce((n,a)=>(a.id===r?n.push(t,a):n.push({...a,children:a.children?E.insertBefore(a.children,r,t):void 0}),n),[])},insertAfter(e,r,t){if(!Array.isArray(e)||!r||!t)throw new Error("Invalid input for insertAfter method");return e.reduce((n,a)=>(a.id===r?n.push(a,t):n.push({...a,children:a.children?E.insertAfter(a.children,r,t):void 0}),n),[])},insertChild(e,r,t){if(!Array.isArray(e)||!r||!t)throw new Error("Invalid input for insertChild method");return e.map(n=>n.id===r?{...n,children:[...n.children??[],t]}:{...n,children:n.children?E.insertChild(n.children,r,t):void 0})},find(e,r){if(!Array.isArray(e)||!r)throw new Error("Invalid input for find method");for(const t of e){if(t.id===r)return t;if(t.children){const n=E.find(t.children,r);if(n)return n}}},getPathToItem({current:e,targetId:r,parentIds:t=[]}){if(!Array.isArray(e)||!r||!t)throw new Error("Invalid input for getPathToItem method");for(const n of e){if(n.id===r)return[...t,n.id];if(n.children){const a=E.getPathToItem({current:n.children,targetId:r,parentIds:[...t,n.id].filter(i=>typeof i<"u")});if(a)return a}}},hasChildren(e){return e.children&&e.children.length>0},getAllIds(e){if(!Array.isArray(e))throw new Error("Invalid input for getAllIds method");let r=[];function t(n){var a;n.id&&r.push(n.id),E.hasChildren(n)&&((a=n.children)==null||a.forEach(i=>t(i)))}return e.forEach(n=>t(n)),r},traverse(e,r){if(!Array.isArray(e))throw new Error("Invalid input for traverseTree method");e.forEach(t=>{r(t),E.hasChildren(t)&&E.traverse(t.children??[],r)})}};function Ft(e,r){const t=E.find(e,r.itemId);if(!t)return e;if(r.type==="instruction"){const n=r.instruction;if(n.type==="reparent"){const a=E.getPathToItem({current:e,targetId:r.targetId});if(!a){console.error(`missing ${a}`);return}const i=a[n.desiredLevel];let l=E.remove(e,r.itemId);return l=E.insertAfter(l,i,t),l}if(r.itemId===r.targetId)return e;if(n.type==="reorder-above"){let a=E.remove(e,r.itemId);return a=E.insertBefore(a,r.targetId,t),a}if(n.type==="reorder-below"){let a=E.remove(e,r.itemId);return a=E.insertAfter(a,r.targetId,t),a}if(n.type==="make-child"){let a=E.remove(e,r.itemId);return a=E.insertChild(a,r.targetId,t),a}return console.warn("TODO: action not implemented",n),e}if(r.type==="modal-move"){let n=E.remove(e,t==null?void 0:t.id);const a=Kt(n,r.targetId)??[];if(a.length===0)r.targetId===""?n=[t]:n=E.insertChild(n,r.targetId,t);else if(r.index===a.length){const i=a[a.length-1];n=E.insertAfter(n,i.id,t)}else{const i=a[r.index];n=E.insertBefore(n,i.id,t)}return n}return e}function Kt(e,r){if(r==="")return e;const t=E.find(e,r);if(!t){console.error(`missing ${t}`);return}return t.children}const Le={},$t=e=>{Le[e]=!0},Wt={key:0,class:"pl-2"},zt={key:1,class:"pl-2"},Yt=c.defineComponent({__name:"el-table-tree-item-dnd",props:{column:{},item:{},expandItem:{type:Function},closeItem:{type:Function},allowDrag:{type:Function},allowDrop:{type:Function}},emits:["node-drag-start","node-drag-enter","node-drag-leave","node-drag-over","node-drag-end"],setup(e,{emit:r}){const t=e,n=r,a=c.ref(),i=c.ref(!1),l=c.computed(()=>t.item.hasChildren?"expanded":"standard"),d=c.ref(null);let u;return c.onMounted(()=>{var m,f,h;let v;a.value&&(v=(m=a.value)==null?void 0:m.closest(".el-table__row"));const T=c.ref(v),g=c.unref(T);g&&(Le[(f=t.item)==null?void 0:f.index]||($t((h=t.item)==null?void 0:h.index),u=R(It({element:g,getInitialData:()=>({...t.item.value,level:t.item.level,id:t.item.id}),onDragStart:s=>{var y;i.value=!0,(y=t==null?void 0:t.closeItem)==null||y.call(t,t.item.value),n("node-drag-start",s.source)},canDrag(){var s;return t!=null&&t.allowDrag&&typeof t.allowDrag=="function"?!!((s=t==null?void 0:t.allowDrag)!=null&&s.call(t,{dragSource:t.item.value})):!0},onDrop:()=>{var s;i.value=!1,(s=t==null?void 0:t.expandItem)==null||s.call(t,t.item.value)}}),Pt({element:g,getData:({input:s,element:y})=>{const o={id:t.item.id};return Rt(o,{input:s,element:y,indentPerLevel:16,currentLevel:t.item.level,mode:l.value,block:[]})},canDrop:({source:s})=>{var y,o;return t!=null&&t.allowDrop&&typeof t.allowDrop=="function"?!!((o=t==null?void 0:t.allowDrop)!=null&&o.call(t,{dragSource:s==null?void 0:s.data,dropTarget:(y=t.item)==null?void 0:y.value})):s.data.id!==t.item.id},onDrag:({self:s,source:y,location:o})=>{var b,w,D;d.value=Ne(s.data),n("node-drag-over",y==null?void 0:y.data,(D=(w=(b=o==null?void 0:o.current)==null?void 0:b.dropTargets)==null?void 0:w[0])==null?void 0:D.data)},onDragEnter:({source:s,location:y})=>{var o,b,w,D,p;s.data.id!==t.item.id&&((b=t==null?void 0:t.expandItem)==null||b.call(t,(o=t.item)==null?void 0:o.value)),n("node-drag-enter",s==null?void 0:s.data,(p=(D=(w=y==null?void 0:y.current)==null?void 0:w.dropTargets)==null?void 0:D[0])==null?void 0:p.data)},onDragLeave:({source:s,location:y})=>{var o,b,w;d.value=null,n("node-drag-leave",s==null?void 0:s.data,(w=(b=(o=y==null?void 0:y.current)==null?void 0:o.dropTargets)==null?void 0:b[0])==null?void 0:w.data)},onDrop:({source:s,location:y})=>{var o,b,w;d.value=null,y.current.dropTargets[0].data.id===t.item.id&&c.nextTick(()=>{var D,p;(p=t==null?void 0:t.expandItem)==null||p.call(t,(D=t.item)==null?void 0:D.value)}),n("node-drag-end",s==null?void 0:s.data,(w=(b=(o=y==null?void 0:y.current)==null?void 0:o.dropTargets)==null?void 0:b[0])==null?void 0:w.data)},getIsSticky:()=>!0}),Ie({canMonitor:({source:s})=>s.data.id!==t.item.id}))))}),c.onBeforeUnmount(()=>{u==null||u()}),(v,T)=>{var g,m,f,h,s,y,o,b,w,D,p,O,P,A,I,j,C,S,x,M,U;return c.openBlock(),c.createElementBlock("span",{ref_key:"spanRef",ref:a,class:c.normalizeClass({"opacity-50":i.value})},[(m=(g=t.column)==null?void 0:g.slots)!=null&&m.default?(c.openBlock(),c.createElementBlock("span",Wt,[c.renderSlot(v.$slots,(h=(f=t.column)==null?void 0:f.slots)==null?void 0:h.default)])):(c.openBlock(),c.createElementBlock("span",zt,c.toDisplayString(((p=(s=t==null?void 0:t.column)==null?void 0:s.formatter)==null?void 0:p.call(s,(y=t.item)==null?void 0:y.value,t==null?void 0:t.column,(w=(o=t.item)==null?void 0:o.value)==null?void 0:w[(b=t.column)==null?void 0:b.prop],(D=t.item)==null?void 0:D.index))||((A=(O=t.item)==null?void 0:O.value)==null?void 0:A[(P=t.column)==null?void 0:P.prop])),1)),d.value?(c.openBlock(),c.createElementBlock("span",{key:2,class:c.normalizeClass(["absolute h-full w-full top-0 border-blue-500",{"!border-b-2":((I=d.value)==null?void 0:I.type)==="reorder-below","!border-t-2":((j=d.value)==null?void 0:j.type)==="reorder-above","!border-2 rounded":((C=d.value)==null?void 0:C.type)==="make-child"}]),style:c.normalizeStyle({left:`${((S=d.value)==null?void 0:S.currentLevel)*((x=d.value)==null?void 0:x.indentPerLevel)}px`,width:`calc(100% - ${((M=d.value)==null?void 0:M.currentLevel)*((U=d.value)==null?void 0:U.indentPerLevel)}px)`})},null,6)):c.createCommentVNode("",!0)],2)}}}),Ut={class:"el-table-tree-dnd"},Vt=((e,r)=>{const t=e.__vccOpts||e;for(const[n,a]of r)t[n]=a;return t})(c.defineComponent({__name:"el-table-tree-dnd",props:{data:{default:()=>[]},columns:{default:()=>[]},pagination:{},size:{},width:{},height:{},maxHeight:{},fit:{type:Boolean},stripe:{type:Boolean},border:{type:Boolean,default:!0},rowKey:{type:[String,Function],default:"id"},context:{},showHeader:{type:Boolean},showSummary:{type:Boolean},sumText:{},summaryMethod:{},rowClassName:{},rowStyle:{},cellClassName:{},cellStyle:{},headerRowClassName:{},headerRowStyle:{},headerCellClassName:{},headerCellStyle:{},highlightCurrentRow:{type:Boolean},currentRowKey:{},emptyText:{},expandRowKeys:{},defaultExpandAll:{type:Boolean,default:!0},defaultSort:{},tooltipEffect:{},tooltipOptions:{},spanMethod:{},selectOnIndeterminate:{type:Boolean},indent:{},treeProps:{default:()=>({hasChildren:"hasChildren",children:"children",label:"label"})},lazy:{type:Boolean,default:!1},load:{},className:{},style:{},tableLayout:{},scrollbarAlwaysOn:{type:Boolean},flexible:{type:Boolean},showOverflowTooltip:{type:[Boolean,Object],default:!0},draggable:{type:Boolean,default:!0},allowDrag:{},allowDrop:{}},emits:["node-drag-start","node-drop","node-drag-enter","node-drag-leave","node-drag-over","node-drag-end","selection-change","size-change","current-change"],setup(e,{expose:r,emit:t}){const n=e,a=t,i=c.ref(),l=g=>{var m;(m=i.value)==null||m.toggleRowExpansion(g,!0)},d=g=>{var m;(m=i.value)==null||m.toggleRowExpansion(g,!1)};c.watchEffect(g=>{const m=R(Ie({onDrop(f){const{location:h,source:s}=f;if(!h.current.dropTargets.length)return;const y=s.data.id,o=h.current.dropTargets[0],b=o.data.id,w=Ne(o.data);if(w!==null){const D=Ft(n.data,{type:"instruction",instruction:w,itemId:y,targetId:b})??[],p=E.find(c.toRaw(n.data),b);a("node-drop",{newNodeData:D,oldNodeData:c.toRaw(n.data),dragSource:s.data,dropTarget:p})}}}));g(()=>{m()})});const u=g=>{a("node-drag-start",{dragSource:g})},v=(g,m,f)=>{const h=E.find(c.toRaw(n.data),m==null?void 0:m.id);a(`node-drag-${f}`,{dragSource:g,dropTarget:h})},T=c.computed(()=>Object.assign({small:!1,background:!1,pagerCount:7,layout:"sizes, prev, pager, next, jumper, ->, total",pageSizes:[10,20,30,40,50,100],disabled:!1,hideOnSinglePage:!1,total:10},(n==null?void 0:n.pagination)||{}));return r({getElTableExpose:async()=>(await c.nextTick(),i==null?void 0:i.value)}),(g,m)=>{const f=c.resolveComponent("el-table-column"),h=c.resolveComponent("el-table"),s=c.resolveComponent("el-pagination"),y=c.resolveDirective("loading");return c.openBlock(),c.createElementBlock("div",Ut,[c.withDirectives((c.openBlock(),c.createBlock(h,{ref_key:"tableRef",ref:i,data:n.data,"row-key":n.rowKey,border:n.border,"default-expand-all":n.defaultExpandAll,showOverflowTooltip:n.showOverflowTooltip,lazy:n.lazy,"tree-props":{children:"children",hasChildren:"hasChildren"},onSelectionChange:m[4]||(m[4]=o=>{a("selection-change",o)})},{default:c.withCtx(()=>[(c.openBlock(!0),c.createElementBlock(c.Fragment,null,c.renderList(n.columns,(o,b)=>{var w,D;return c.openBlock(),c.createBlock(f,c.mergeProps({key:`table-column-${b}`,align:o.align,headerAlign:o.headerAlign,prop:o==null?void 0:o.prop,label:o.label,type:o.type,"reserve-selection":o.reserveSelection,selectable:o.selectable,fixed:o.fixed,width:o.width,ref_for:!0},o),c.createSlots({_:2},[(w=o==null?void 0:o.slots)!=null&&w.header?{name:"header",fn:c.withCtx(()=>{var p;return[c.renderSlot(g.$slots,(p=o==null?void 0:o.slots)==null?void 0:p.header,{},void 0,!0)]}),key:"0"}:void 0,o.type!=="selection"&&o.type!=="index"&&n.draggable?{name:"default",fn:c.withCtx(p=>{var O,P,A,I,j,C;return[c.createVNode(Yt,{item:{id:(O=p==null?void 0:p.row)==null?void 0:O.id,index:p==null?void 0:p.$index,level:(P=p==null?void 0:p.treeNode)==null?void 0:P.level,value:p==null?void 0:p.row,hasChildren:!!((I=(A=p==null?void 0:p.row)==null?void 0:A.children)!=null&&I.length)},column:o,"expand-item":l,"close-item":d,onNodeDragStart:u,onNodeDragEnter:m[0]||(m[0]=(S,x)=>{v(S,x,"enter")}),onNodeDragLeave:m[1]||(m[1]=(S,x)=>{v(S,x,"leave")}),onNodeDragOver:m[2]||(m[2]=(S,x)=>{v(S,x,"over")}),onNodeDragEnd:m[3]||(m[3]=(S,x)=>{v(S,x,"end")}),"allow-drag":n==null?void 0:n.allowDrag,"allow-drop":n==null?void 0:n.allowDrop},c.createSlots({_:2},[(j=o==null?void 0:o.slots)!=null&&j.default?{name:(C=o==null?void 0:o.slots)==null?void 0:C.default,fn:c.withCtx(()=>{var S;return[c.renderSlot(g.$slots,(S=o==null?void 0:o.slots)==null?void 0:S.default,{row:p==null?void 0:p.row,column:"column",$index:p==null?void 0:p.$index},void 0,!0)]}),key:"0"}:void 0]),1032,["item","column","allow-drag","allow-drop"])]}),key:"1"}:void 0,!n.draggable&&((D=o==null?void 0:o.slots)!=null&&D.default)?{name:"default",fn:c.withCtx(p=>{var O;return[c.renderSlot(g.$slots,(O=o==null?void 0:o.slots)==null?void 0:O.default,{row:p==null?void 0:p.row,column:"column",$index:p==null?void 0:p.$index},void 0,!0)]}),key:"2"}:void 0]),1040,["align","headerAlign","prop","label","type","reserve-selection","selectable","fixed","width"])}),128))]),_:3},8,["data","row-key","border","default-expand-all","showOverflowTooltip","lazy"])),[[y,n.loading]]),n.pagination?(c.openBlock(),c.createBlock(s,c.mergeProps({key:0},T.value,{onSizeChange:m[5]||(m[5]=o=>{a("size-change",o)}),onCurrentChange:m[6]||(m[6]=o=>{a("current-change",o)}),style:{"margin-top":"10px"}}),null,16)):c.createCommentVNode("",!0)])}}}),[["__scopeId","data-v-9a30b557"]]);k.default=Vt,k.treeHandler=E,Object.defineProperties(k,{__esModule:{value:!0},[Symbol.toStringTag]:{value:"Module"}})});
